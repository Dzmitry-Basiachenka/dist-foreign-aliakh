swagger: '2.0'
info:
  title: FDA REST Services
  description: Set of services implemented for FDA.
  version: 1.0.0
host: 'dist-foreign.aws-p-dev.copyright.com'
schemes:
  - http
basePath: /dist-foreign-ui
produces:
  - application/json
paths:
  /jobs/{jobName:.+}:
    get:
      operationId: getJobStatus
      summary: Gets status of the job
      tags:
        - jobs
      parameters:
        - $ref: '#/parameters/job_name'
        - name: jobName
          in: path
          required: true
          type: string
      responses:
        200:
          description: The job is waiting
          schema:
            $ref: '#/definitions/JobStatus'
        202:
          description: The job is running
          schema:
            $ref: '#/definitions/JobStatus'
        404:
          description: Job not found. Error code [NOT_FOUND]
          schema:
            $ref: '#/definitions/Error'
        500:
          description: Unexpected error. Error code [INTERNAL_SERVER_ERROR]
          schema:
            $ref: '#/definitions/Error'
    post:
      operationId: triggerJob
      summary: Triggers the job
      tags:
        - jobs
      parameters:
        - $ref: '#/parameters/job_name'
        - name: jobName
          in: path
          required: true
          type: string
      responses:
        200:
          description: The job is triggred
          schema:
            $ref: '#/definitions/JobStatus'
        202:
          description: The job is already running
          schema:
            $ref: '#/definitions/JobStatus'
        404:
          description: Job not found. Error code [NOT_FOUND]
          schema:
            $ref: '#/definitions/Error'
        500:
          description: Unexpected error. Error code [INTERNAL_SERVER_ERROR]
          schema:
            $ref: '#/definitions/Error'

  /statistic:
    get:
      operationId: getBatchStatistic
      summary: Gets status of batch by action date
      tags:
        - statistic
      parameters:
        - name: name
          in: query
          required: true
          type: string
          description: Batch name
        - name: date
          in: query
          required: false
          type: string
          pattern: '^\d{2}/\d{2}/\d{4}$'
          description: Batch action date in the format MM/dd/yyyy
      responses:
        200:
          description: Batch statistic
          schema:
            $ref: '#/definitions/BatchStatistic'
        404:
          description: Batch not found by name. Error code [NOT_FOUND]
          schema:
            $ref: '#/definitions/Error'
        500:
          description: Unexpected error. Error code [INTERNAL_SERVER_ERROR]
          schema:
            $ref: '#/definitions/Error'

definitions:
  Error:
    description: Error
    type: object
    properties:
      error:
        type: string
        example: ERROR_CODE
      message:
        type: string
        example: Field value is not valid. Field=name, Value=null, Reason=may not be null
      stackTrace:
        type: string
        example: java.lang.NullPointerException\n\tat java.lang.Thread.run(Thread.java:748)

  JobStatus:
    description: JobStatus
    type: object
    properties:
      status:
        type: string

  BatchStatistic:
    description: Batch statistic
    type: object
    properties:
      batchName:
        type: string
      date:
        type: string
      loadedCount:
        type: integer
      loadedAmount:
        type: number
      matchedCount:
        type: integer
      matchedAmount:
        type: number
      matchedPercent:
        type: number
      worksNotFoundCount:
        type: integer
      worksNotFoundAmount:
        type: number
      worksNotFoundPercent:
        type: number
      multipleMatchingCount:
        type: integer
      multipleMatchingAmount:
        type: number
      multipleMatchingPercent:
        type: number
      ntsWithDrawnCount:
        type: integer
      ntsWithDrawnAmount:
        type: number
      ntsWithDrawnPercent:
        type: number
      rhNotFoundCount:
        type: integer
      rhNotFoundAmount:
        type: number
      rhNotFoundPercent:
        type: number
      eligibleCount:
        type: integer
      eligibleAmount:
        type: number
      eligiblePercent:
        type: number
      sendForRaCount:
        type: integer
      sendForRaAmount:
        type: number
      sendForRaPercent:
        type: number
      paidCount:
        type: integer
      paidAmount:
        type: number
      paidPercent:
        type: number

parameters:
  job_name:
    name: jobName
    in: path
    required: true
    type: string
